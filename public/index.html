<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Phishing Threat Report Form</title>
		<style>
			body {
				font-family: Arial, sans-serif;
				line-height: 1.6;
				max-width: 800px;
				margin: 0 auto;
				padding: 20px;
				background-color: #f5f5f5;
			}

			.container {
				background-color: white;
				padding: 2rem;
				border-radius: 8px;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			}

			.top-links {
				display: flex;

				justify-content: space-between;

				margin-bottom: 1.5rem;
			}

			.top-link {
				flex: 1;

				margin: 0 10px;

				padding: 1rem;

				text-align: center;

				background-color: #3498db;

				color: white;

				border-radius: 8px;

				text-decoration: none;

				font-weight: bold;

				transition: background-color 0.3s;
			}

			.top-link:hover {
				background-color: #2980b9;
			}

			h1 {
				color: #2c3e50;
				margin-bottom: 1.5rem;
			}

			.form-group {
				margin-bottom: 1.5rem;
			}

			label {
				display: block;
				margin-bottom: 0.5rem;
				font-weight: bold;
				color: #34495e;
			}

			input[type='text'],
			select,
			textarea {
				width: 100%;
				padding: 0.5rem;
				border: 1px solid #ddd;
				border-radius: 4px;
				font-size: 1rem;
			}

			textarea {
				height: 100px;
				resize: vertical;
			}

			select {
				background-color: white;
			}

			button {
				background-color: #3498db;
				color: white;
				padding: 0.75rem 1.5rem;
				border: none;
				border-radius: 4px;
				cursor: pointer;
				font-size: 1rem;
				transition: background-color 0.3s;
			}

			button:hover {
				background-color: #2980b9;
			}

			.alert {
				padding: 1rem;
				margin-bottom: 1rem;
				border-radius: 4px;
				background-color: #f8d7da;
				color: #721c24;
				display: none;
			}
		</style>
	</head>
	<body>
		<div class="container">
			<div class="top-links">
				<a
					href="https://www.microsoft.com/en-us/wdsi/support/report-unsafe-site-guest"
					class="top-link"
					target="_blank"
					rel="noopener noreferrer external"
					>Report to Microsoft</a
				>
				<a
					href="https://safebrowsing.google.com/safebrowsing/report_phish/?hl=en"
					class="top-link"
					target="_blank"
					rel="noopener noreferrer external"
					>Report to Google</a
				>
			</div>
			<h1>Report Phishing Threat</h1>

			<div id="error-message" class="alert"></div>

			<form id="phishingForm" method="POST">
				<div class="form-group">
					<label for="name">Name:</label>
					<input type="text" id="name" name="name" required />
				</div>

				<div class="form-group">
					<label for="category">Category:</label>
					<select id="category" name="category" required>
						<option value="">Select a category...</option>
						<option value="Phishing">Phishing</option>
						<option value="Crypto Scam">Crypto Scam</option>
						<option value="Other">Other</option>
					</select>
				</div>

				<div class="form-group">
					<label for="source">Source:</label>
					<select id="source" name="source" required>
						<option value="">Select a source...</option>
						<option value="Email">Email</option>
						<option value="SMS">SMS</option>
						<option value="Other">Other</option>
					</select>
				</div>

				<div class="form-group">
					<label for="url">URL:</label>
					<input type="url" id="url" name="url" required />
				</div>

				<div class="form-group">
					<label for="description">Description:</label>
					<textarea id="description" name="description" required></textarea>
				</div>

				<div class="form-group">
					<label for="skip_urlscan">Skip URLScan API:</label>
					<input type="checkbox" id="skip_urlscan" name="skip_urlscan" />
				</div>

				<div class="form-group">
					<label for="skip_virustotal">Skip VirusTotal API:</label>
					<input type="checkbox" id="skip_virustotal" name="skip_virustotal" />
				</div>

				<div class="form-group">
					<label for="skip_cloudflare">Skip Cloudflare URLScanner API:</label>
					<input type="checkbox" id="skip_cloudflare" name="skip_cloudflare" />
				</div>

				<button type="submit">Submit Report</button>
			</form>
		</div>

		<script>
			document.getElementById('phishingForm').addEventListener('submit', async function (e) {
				e.preventDefault();

				const formData = {
					name: document.getElementById('name').value,
					category: document.getElementById('category').value,
					source: document.getElementById('source').value,
					url: document.getElementById('url').value,
					description: document.getElementById('description').value,
					skip_urlscan: document.getElementById('skip_urlscan').checked,
					skip_virustotal: document.getElementById('skip_virustotal').checked,
					skip_cloudflare: document.getElementById('skip_cloudflare').checked,
				};

				const response = await fetch('/submit', {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify(formData),
				});

				if (response.ok) {
					const data = await response.json();

					// Display the result
					const resultContainer = document.createElement('div');
					resultContainer.innerHTML = `
      <p>Submission successful!</p>
      <p><strong>Report UUID:</strong> ${data.id}</p>
      ${
				data.scan_uuid
					? `<p><strong>URLScan UUID:</strong> <a href="https://urlscan.io/result/${data.scan_uuid}/" target="_blank" rel="nofollow noreferrer external">${data.scan_uuid}</a></p>`
					: ''
			}
      ${
				data.virustotal_scan_id
					? `<p><strong>VirusTotal Scan ID:</strong> <a href="https://www.virustotal.com/gui/url/${data.virustotal_scan_id}" target="_blank" rel="nofollow noreferrer external">${data.virustotal_scan_id}</a></p>`
					: ''
			}
      ${
				data.cloudflare_scan_uuid
					? `<p><strong>Cloudflare URLScanner ID:</strong> <a href="https://radar.cloudflare.com/scan/${data.cloudflare_scan_uuid}/summary" target="_blank" rel="nofollow noreferrer external">${data.cloudflare_scan_uuid}</a></p>`
					: ''
			}
    `;
					document.body.appendChild(resultContainer);
				} else {
					alert('Error: Could not submit the report.');
				}
			});
		</script>
	</body>
</html>
